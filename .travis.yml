language: php

php:
  - 5.4
  - 5.5
  - 5.6
  - 7
  - hhvm

services:
  - mongodb
  - redis-server
  - memcached

notifications:
  email:
    - daniel.gonzalez@freelancemadrid.es

before_script:

#   Create Mysqli Database
  - mysql -e 'CREATE DATABASE IF NOT EXISTS `cache`;'
  - mysql -e 'USE `cache`; CREATE TABLE `cache` (`k` varchar(255) NOT NULL, `v` text NOT NULL, `t` int(11) NOT NULL, PRIMARY KEY (`k`)) ENGINE=InnoDB DEFAULT CHARSET=utf8;'

#   Install dependencies
  - composer self-update
  - composer install --prefer-source

  - - sh -c "if [[ $TRAVIS_PHP_VERSION != 'hhvm' && `php-config --vernum` -ge 50500 ]] ; then pecl config-set preferred_state beta; printf "yes\n" | pecl install apcu ; else echo 'extension="apc.so"' >> ./tests/travis/php.ini ;fi"

#   Set Configuration
  - cp tests/config.json.dist tests/config.json

script: phpunit -v